---
import type { GetStaticPaths } from 'astro'
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export const getStaticPaths = (async () => {
  const courses = await getCollection('courses')
  return courses.map(course => {
    const [dirWithNo, slugWithNo] = course.id.split('/')
    const dir = dirWithNo.match(/(?<=-).+/g)?.[0]
    const slug = slugWithNo.match(/(?<=-).+(?=\..+)/g)?.[0]
    if (!dir || !slug) {
      throw new Error(`dir or slug pattern is incorrect on ${course.id}`)
    }
    return {
      params: { dir, slug },
      props: course
    }
  })
}) satisfies GetStaticPaths

const { body } = Astro.props
---

<BaseLayout>
  <Fragment set:html={body}></Fragment>
</BaseLayout>
